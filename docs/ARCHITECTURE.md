# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ CookaReq

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ–º–æ–≥–∞–µ—Ç –±—ã—Å—Ç—Ä–æ —Å–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –∫–æ–¥–æ–≤–æ–π –±–∞–∑–µ –∏ –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–π —Å–ª–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –∏–ª–∏ MCP-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é.

## –°–ª–æ–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

- **GUI (`app/ui`)** ‚Äî –≤–∏–¥–∂–µ—Ç—ã wxPython, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ–≤–µ—Ä—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤ –∏ –º–æ–¥–µ–ª–µ–π, –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–º–∏ —á–µ—Ä–µ–∑ `RequirementModel` –∏ `DocumentsController`, –∞ —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –¥–æ—Å—Ç—É–ø –∫ –∞–≥–µ–Ω—Ç—É (`LocalAgent`).
- **–Ø–¥—Ä–æ (`app/core`)** ‚Äî –¥–æ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π, —Ñ–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (`document_store`) –∏ —É—Ç–∏–ª–∏—Ç—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏/–ø–æ–∏—Å–∫–∞. –≠—Ç–∏–º –∂–µ API –ø–æ–ª—å–∑—É—é—Ç—Å—è CLI, MCP –∏ –∞–≥–µ–Ω—Ç.
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (`app/agent`, `app/llm`, `app/mcp`)** ‚Äî –æ–±—ë—Ä—Ç–∫–∏ –≤–æ–∫—Ä—É–≥ LLM –∏ MCP —Å–µ—Ä–≤–µ—Ä–∞/–∫–ª–∏–µ–Ω—Ç–∞, —Å–≤—è–∑—ã–≤–∞—é—â–∏–µ –≤–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã —Å –ª–æ–∫–∞–ª—å–Ω—ã–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º.
- **–ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ (`app/cli`)** ‚Äî –æ–±–æ–ª–æ—á–∫–∞ –Ω–∞–¥ `document_store`, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∞—è —Å—Ü–µ–Ω–∞—Ä–∏–∏ –±–µ–∑ GUI.
- **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–ª—É–∂–±—ã** ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã.

## –ö–∞—Ä—Ç–∞ –∫–ª—é—á–µ–≤—ã—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤

### `app/`
- `main.py` ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ GUI: —Å–æ–∑–¥–∞—ë—Ç `wx.App`, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç `ConfigManager`, `RequirementModel` –∏ –æ–∫–Ω–æ `MainFrame` —Å –º–µ–Ω—é, –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞–º–∏ –∏ –∞–≥–µ–Ω—Ç–æ–º.„ÄêF:app/main.py‚Ä†L5-L55„Äë
- `config.py` ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä `ConfigManager`, –∫–æ—Ç–æ—Ä—ã–π —á–∏—Ç–∞–µ—Ç/–ø–∏—à–µ—Ç JSON —Å –ø–æ–º–æ—â—å—é Pydantic-–º–æ–¥–µ–ª–∏ `AppSettings` –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Ö—Ä–∞–Ω–∏—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –∫–ª—é—á–∏ (—à–∏—Ä–∏–Ω—ã –∫–æ–ª–æ–Ω–æ–∫, –ø–æ–∑–∏—Ü–∏–∏ —Å–ø–ª–∏—Ç—Ç–µ—Ä–æ–≤) –¥–ª—è wx-–≤–∏–¥–∂–µ—Ç–æ–≤.„ÄêF:app/config.py‚Ä†L1-L213„Äë
- `settings.py` ‚Äî pydantic-–º–æ–¥–µ–ª–∏ `AppSettings`, `LLMSettings`, `MCPSettings`, `UISettings` –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥–æ–≤ –∏–∑ JSON/TOML. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `LLMSettings` –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç OpenRouter (`https://openrouter.ai/api/v1`) –∏ –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –º–æ–¥–µ–ª—å `meta-llama/llama-3.3-70b-instruct:free`: –æ–Ω–∞ –ø—Ä–æ—à–ª–∞ —Ä—É—á–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π –ø—Ä–æ–≥–æ–Ω —Å—Ü–µ–Ω–∞—Ä–∏—è ¬´–∏—Å–ø—Ä–∞–≤—å –æ–ø–∏—Å–∞–Ω–∏–µ –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–∏¬ª –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `update_requirement_field`, —Ç–æ–≥–¥–∞ –∫–∞–∫ –¥—Ä—É–≥–∏–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏ –ª–∏–±–æ –∑–∞–¥–∞–≤–∞–ª–∏ —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã, –ª–∏–±–æ –≤–æ–æ–±—â–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª–∏ tool-calls.„ÄêF:app/settings.py‚Ä†L14-L110„Äë„ÄêF:app/llm/constants.py‚Ä†L1-L12„Äë
- `confirm.py` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—â–∏—Ö –¥–∏–∞–ª–æ–≥–æ–≤ (`set_confirm`, `confirm`, `wx_confirm`, `auto_confirm`). `wx_confirm` –∏ `wx_confirm_requirement_update` –º–∞—Ä—à–∞–ª—è—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ –≥–ª–∞–≤–Ω—ã–π –ø–æ—Ç–æ–∫ wx —á–µ—Ä–µ–∑ `_call_in_wx_main_thread`, –ø–æ—ç—Ç–æ–º—É –∏—Ö –º–æ–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å –∏–∑ —Ñ–æ–Ω–æ–≤—ã—Ö –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –∞–≥–µ–Ω—Ç–∞ –±–µ–∑ –∫—Ä–∞—à–µ–π –≤ `wxThread::IsMain`.„ÄêF:app/confirm.py‚Ä†L1-L31„Äë„ÄêF:app/confirm.py‚Ä†L214-L323„Äë
- `i18n.py` ‚Äî –ª—ë–≥–∫–∞—è –æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º `gettext`: —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ—Ç `gettext.translation`, –∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ `.mo` –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç `.po` —á–µ—Ä–µ–∑ `polib` –≤ –ø–∞–º—è—Ç–∏ –∏ –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç `_`/`ngettext`/`pgettext` –¥–ª—è GUI –∏ CLI.„ÄêF:app/i18n.py‚Ä†L1-L122„Äë
- `log.py` –∏ `telemetry.py` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (`configure_logging`, `ConsoleFormatter`, `JsonlHandler`) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ `RotatingFileHandler` –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ, —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∏ JSONL-–ª–æ–≥–æ–≤, –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ä–æ—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å –≤ –ø–æ—Ç–æ–∫, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–æ–º –ª–æ–≥–æ–≤ (`get_log_directory`, `open_log_directory`) –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è (`log_event`, —Å–∞–Ω–∏—Ç–∞–π–∑–∏–Ω–≥ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö). –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä –∏–∑–≤–ª–µ–∫–∞–µ—Ç –ø–æ–ª–µ–∑–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π, –ø–æ—ç—Ç–æ–º—É –≤ stdout –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø–æ–ª–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ LLM-–∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–∏ —É—Ä–æ–≤–Ω–µ DEBUG.„ÄêF:app/log.py‚Ä†L1-L213„Äë„ÄêF:app/telemetry.py‚Ä†L1-L49„Äë
- `util/` ‚Äî –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ (`utc_now_iso`, `normalize_timestamp`) –∏ –¥—Ä—É–≥–∏–µ –º–µ–ª–∫–∏–µ —É—Ç–∏–ª–∏—Ç—ã.„ÄêF:app/util/time.py‚Ä†L1-L27„Äë
- `resources/` –∏ `locale/` ‚Äî –∏–∫–æ–Ω–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –∫–∞—Ç–∞–ª–æ–≥–∏ –ø–µ—Ä–µ–≤–æ–¥–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ `MainFrame` –∏ `init_locale`.

### `app/core/`
- `model.py` ‚Äî –¥–æ–º–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è (`RequirementType`, `Status`, ‚Ä¶), –¥–∞—Ç–∞-–∫–ª–∞—Å—Å—ã `Requirement`, `Attachment`, `Link`, –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–ø–µ—á–∞—Ç–∫–æ–≤ (`requirement_fingerprint`) –∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π.„ÄêF:app/core/model.py‚Ä†L1-L184„Äë„ÄêF:app/core/model.py‚Ä†L246-L325„Äë
- `document_store/` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –¥–∏—Å–∫–æ–≤—ã–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º: —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `Document`, `DocumentLabels`, `RequirementPage`, –∑–∞–≥—Ä—É–∑–∫–∞/—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (`documents.py`), CRUD –ø–æ —ç–ª–µ–º–µ–Ω—Ç–∞–º (`items.py`) –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑—è–º–∏ (`links.py`). –§—É–Ω–∫—Ü–∏–∏ `update_requirement_field`, `set_requirement_labels`, `set_requirement_attachments`, `set_requirement_links` –∑–∞–º–µ–Ω—è—é—Ç JSON Patch –∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç `revision`, –ø–µ—Ä–µ–∫–ª–∞–¥—ã–≤–∞—è –≤—ã–±–æ—Ä –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –ø–æ–ª–µ–π –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é –º–µ—Ç–æ–∫ –Ω–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ. –î–ª—è —Å—Ü–µ–Ω–∞—Ä–∏—è —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –∫–ª–∏–µ–Ω—Ç–æ–º —É–±—Ä–∞–Ω–∞ –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞: —É–¥–∞–ª–µ–Ω–∏–µ –∏ –ø—Ä–∏–≤—è–∑–∫–∞ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –±–æ–ª—å—à–µ –Ω–µ —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–¥–∞—á–∏ –æ–∂–∏–¥–∞–µ–º–æ–π —Ä–µ–≤–∏–∑–∏–∏, –∞ `delete_requirement`/`link_requirements` –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Ç–æ–ª—å–∫–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π. –•—Ä–∞–Ω–∏–ª–∏—â–µ —á–∏—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∫–∞–Ω–æ–Ω–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã `items/<id>.json`; –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤–∞–Ω–Ω—ã—Ö (`SYS0005.json`) –∏–ª–∏ –Ω—É–ª–µ–≤—ã—Ö (`0005.json`) –∏–º—ë–Ω –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `LegacyItemLayoutError` —Å–æ —Å–ø–∏—Å–∫–æ–º –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏—Ö –ø—É—Ç–µ–π –∏ –ø–æ–¥—Å–∫–∞–∑–∫–æ–π –≤—Ä—É—á–Ω—É—é –ø—Ä–∏–≤–µ—Å—Ç–∏ –∏–º–µ–Ω–∞ –∫ –∫–∞–Ω–æ–Ω—É –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ–º —Ä–∞–±–æ—Ç—ã.„ÄêF:app/core/document_store/__init__.py‚Ä†L1-L118„Äë„ÄêF:app/core/document_store/items.py‚Ä†L1-L255„Äë„ÄêF:app/core/document_store/items.py‚Ä†L360-L523„Äë„ÄêF:app/core/document_store/items.py‚Ä†L638-L720„Äë„ÄêF:app/core/document_store/links.py‚Ä†L1-L70„Äë„ÄêF:app/core/document_store/links.py‚Ä†L232-L320„Äë
- `search.py` ‚Äî —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º, –º–µ—Ç–∫–∞–º, —Ç–µ–∫—Å—Ç–æ–≤—ã–º –ø–æ–ª—è–º –∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ—Å—Ç–∏; –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏ GUI, –∏ CLI/MCP.„ÄêF:app/core/search.py‚Ä†L1-L87„Äë„ÄêF:app/core/search.py‚Ä†L120-L184„Äë
- `label_presets.py` ‚Äî –Ω–∞–±–æ—Ä—ã –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ –∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–∞—Å—Ç–µ–ª—å–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤ –¥–ª—è –Ω–∏—Ö.„ÄêF:app/core/label_presets.py‚Ä†L1-L39„Äë

### `app/ui/`
- `main_frame/` ‚Äî –ø–∞–∫–µ—Ç –≥–ª–∞–≤–Ω–æ–≥–æ –æ–∫–Ω–∞. `frame.py` —Å–æ–±–∏—Ä–∞–µ—Ç –ø–∞–Ω–µ–ª–∏ (`DocumentTree`, `ListPanel`, `EditorPanel`, `AgentChatPanel`), –º–µ–Ω—é `Navigation`, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç `MCPController` –∏ —Å–≤—è–∑—ã–≤–∞–µ—Ç `DocumentsController` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –û—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –æ–±–ª–∞—Å—Ç—è–º: `logging.py` —Å–æ–¥–µ—Ä–∂–∏—Ç `WxLogHandler` –∏ –∫–æ–Ω—Å–æ–ª—å –ª–æ–≥–æ–≤; `sections.py` —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ø–ª–∏—Ç—Ç–µ—Ä–∞–º–∏, –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º —Å–µ–∫—Ü–∏–π –∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–µ–π –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤; `documents.py`, `editor.py`, `requirements.py`, `agent.py`, `settings.py`, `shutdown.py` –¥–µ—Ä–∂–∞—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–æ–≤ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, –æ–ø–µ—Ä–∞—Ü–∏–π —Å–æ —Å–ø–∏—Å–∫–æ–º, –∞–≥–µ–Ω—Ç—Å–∫–æ–≥–æ —á–∞—Ç–∞, –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –ú–µ—Ç–æ–¥ `_load_directory` –≤ `documents.py` —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç `MCPSettings.base_path` —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º –∫–∞—Ç–∞–ª–æ–≥–æ–º –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç MCP-—Å–µ—Ä–≤–µ—Ä, —á—Ç–æ–±—ã –∞–≥–µ–Ω—Ç –≤–∏–¥–µ–ª –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è.„ÄêF:app/ui/main_frame/frame.py‚Ä†L1-L213„Äë„ÄêF:app/ui/main_frame/logging.py‚Ä†L1-L150„Äë„ÄêF:app/ui/main_frame/sections.py‚Ä†L1-L217„Äë„ÄêF:app/ui/main_frame/documents.py‚Ä†L1-L253„Äë„ÄêF:app/ui/main_frame/editor.py‚Ä†L1-L174„Äë„ÄêF:app/ui/main_frame/requirements.py‚Ä†L1-L180„Äë„ÄêF:app/ui/main_frame/agent.py‚Ä†L1-L40„Äë„ÄêF:app/ui/main_frame/settings.py‚Ä†L1-L64„Äë„ÄêF:app/ui/main_frame/shutdown.py‚Ä†L1-L156„Äë„ÄêF:app/config.py‚Ä†L272-L311„Äë„ÄêF:app/ui/main_frame/documents.py‚Ä†L79-L160„Äë
- `controllers/documents.py` ‚Äî `DocumentsController` –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏ –∫—ç—à–∏—Ä—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã/—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å ID, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª—ã –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ–º.„ÄêF:app/ui/controllers/documents.py‚Ä†L1-L134„Äë
- `requirement_model.py` ‚Äî –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è, –ø—Ä–∏–º–µ–Ω—è—é—â–∞—è —Ñ–∏–ª—å—Ç—Ä—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ–≤–µ—Ä—Ö —Å–ø–∏—Å–∫–∞ `Requirement`, –¥–æ—Å—Ç—É–ø–Ω–∞—è –≤—Å–µ–º –ø–∞–Ω–µ–ª—è–º GUI.„ÄêF:app/ui/requirement_model.py‚Ä†L1-L92„Äë„ÄêF:app/ui/requirement_model.py‚Ä†L114-L167„Äë
- –ü–∞–Ω–µ–ª–∏: `list_panel.py` (—Ç–∞–±–ª–∏—á–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–º –º–µ–Ω—é), `editor_panel.py` (—Ñ–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∏ –≤–ª–æ–∂–µ–Ω–∏—è–º–∏), `document_tree.py` (–∏–µ—Ä–∞—Ä—Ö–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤), `navigation.py` (–º–µ–Ω—é –∏ —Ö–æ—Ç–∫–µ–∏), –ø–∞–∫–µ—Ç `agent_chat_panel/` (`panel.py` ‚Äî —á–∞—Ç —Å `LocalAgent`, `execution.py` ‚Äî –ø—É–ª –∫–æ–º–∞–Ω–¥ –∏ `_AgentRunHandle`, `tool_summaries.py` ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ MCP-–≤—ã–∑–æ–≤–æ–≤, `history_utils.py` ‚Äî —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –∏ payload). –û—Ç–¥–µ–ª—å–Ω–æ–µ –ø–ª–∞–≤–∞—é—â–µ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äî `detached_editor.py` (–ø–µ—Ä–µ–Ω–æ—Å–∏—Ç `EditorPanel` –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π `wx.Frame`, –∫–æ–≥–¥–∞ –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–¥–∞–∫—Ç–æ—Ä —Å–∫—Ä—ã—Ç).„ÄêF:app/ui/list_panel.py‚Ä†L1-L92„Äë„ÄêF:app/ui/editor_panel.py‚Ä†L1-L81„Äë„ÄêF:app/ui/document_tree.py‚Ä†L1-L83„Äë„ÄêF:app/ui/navigation.py‚Ä†L1-L107„Äë„ÄêF:app/ui/agent_chat_panel/panel.py‚Ä†L1-L214„Äë„ÄêF:app/ui/agent_chat_panel/execution.py‚Ä†L1-L66„Äë„ÄêF:app/ui/agent_chat_panel/tool_summaries.py‚Ä†L1-L198„Äë„ÄêF:app/ui/agent_chat_panel/history_utils.py‚Ä†L1-L82„Äë„ÄêF:app/ui/detached_editor.py‚Ä†L1-L86„Äë
- `agent_chat_panel/panel.py` —É–ø—Ä–∞–≤–ª—è–µ—Ç –±–µ—Å–µ–¥–∞–º–∏ `ChatConversation` (`app/ui/chat_entry.py`), –∫–∞–∂–¥–∞—è —Ö—Ä–∞–Ω–∏—Ç –ø–∞—Ä—ã `ChatEntry` —Å –æ—Ç–º–µ—Ç–∫–∞–º–∏ –≤—Ä–µ–º–µ–Ω–∏ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º. –ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Ä—è–¥–æ–º —Å –∫–∞—Ç–∞–ª–æ–≥–æ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π (`.cookareq/agent_chats.json`), –∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ –∏ transcript —Å –ø—É–∑—ã—Ä—è–º–∏ `TranscriptMessagePanel` –∏ –∫–Ω–æ–ø–∫–∞–º–∏ ¬´Copy conversation¬ª/¬´Copy technical log¬ª. –ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–∞–Ω–µ–ª—å —Å–æ–±–∏—Ä–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç, –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç –µ–≥–æ –∫ `_AgentRunHandle` –∏ `ChatEntry`, —á—Ç–æ–±—ã `_compose_transcript_log_text()` –≤—ã–ø—É—Å–∫–∞–ª –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–π –∂—É—Ä–Ω–∞–ª —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º –ø—Ä–æ–º–ø—Ç–æ–º, –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, —Å–Ω–∞–ø—à–æ—Ç–æ–º `context_messages`, —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ tool-calls. –ü–æ—Å–ª–µ–¥–Ω–µ–º—É –æ—Ç–≤–µ—Ç—É –¥–æ—Å—Ç—É–ø–Ω–∞ –∫–Ω–æ–ø–∫–∞ ¬´–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ç—å¬ª, —É–¥–∞–ª—è—é—â–∞—è —Ç–µ–∫—É—â–∏–π `ChatEntry` –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—é—â–∞—è –∑–∞–ø—Ä–æ—Å; –∫–Ω–æ–ø–∫–∞ ¬´–°—Ç–æ–ø¬ª –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `CancellationEvent` –¥–ª—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–π –æ—Ç–º–µ–Ω—ã. –û—Ç–≤–µ—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è Markdown —á–µ—Ä–µ–∑ `MarkdownContent`, –ø–æ—ç—Ç–æ–º—É —Å–ø–∏—Å–∫–∏ –∏ –∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.„ÄêF:app/ui/agent_chat_panel/panel.py‚Ä†L108-L410„Äë„ÄêF:app/ui/agent_chat_panel/panel.py‚Ä†L636-L739„Äë„ÄêF:app/ui/agent_chat_panel/panel.py‚Ä†L1651-L1782„Äë„ÄêF:app/ui/agent_chat_panel/panel.py‚Ä†L1886-L2179„Äë„ÄêF:app/ui/chat_entry.py‚Ä†L1-L194„Äë„ÄêF:app/ui/widgets/chat_message.py‚Ä†L1-L280„Äë„ÄêF:app/ui/widgets/markdown_view.py‚Ä†L1-L203„Äë„ÄêF:app/ui/text.py‚Ä†L1-L61„Äë„ÄêF:app/util/cancellation.py‚Ä†L1-L59„Äë –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ `MainFrameAgentMixin._agent_context_messages()` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ `[Workspace context]`: –ø–æ—Å–ª–µ –æ–ø–∏—Å–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ø–µ—Ä–µ—á–∏—Å–ª—è–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤ —á–µ–ª–æ–≤–µ–∫–æ-—á–∏—Ç–∞–µ–º–æ–º –≤–∏–¥–µ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É `Selected requirement RID summary: ‚Ä¶`, —á—Ç–æ–±—ã LLM –ø–æ–ª—É—á–∞–ª –º–∞—à–∏–Ω–Ω–æ-—É–¥–æ–±–Ω—ã–π —Å–ø–∏—Å–æ–∫ RID –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–∑—Ä–µ—à–∞–ª –æ–±—Ä–∞—â–µ–Ω–∏—è –≤–∏–¥–∞ ¬´—ç—Ç–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ¬ª. –ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –∑–∞–ø—Ä–æ—Å–∞ `LLMClient._prepare_messages()` —Å–ª–∏–≤–∞–µ—Ç —ç—Ç–æ—Ç —Å–Ω–∏–º–æ–∫ —Å –æ—Å–Ω–æ–≤–Ω—ã–º —Å–∏—Å—Ç–µ–º–Ω—ã–º –ø—Ä–æ–º–ø—Ç–æ–º, –ø–æ—ç—Ç–æ–º—É –≤ `messages` –æ—Å—Ç–∞—ë—Ç—Å—è –µ–¥–∏–Ω—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –±–ª–æ–∫ ‚Äî —Ç–∞–∫ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–∞–∂–µ —Å –±—ç–∫–µ–Ω–¥–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π `system`-–º–µ—Å—Å–µ–¥–∂.„ÄêF:app/llm/client.py‚Ä†L724-L745„Äë„ÄêF:app/ui/main_frame/agent.py‚Ä†L70-L123„Äë
- –ú–æ–¥—É–ª—å `tool_summaries.py` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç `summarize_tool_results()` –∏ —Å–º–µ–∂–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∏–∑–≤–ª–µ–∫–∞—é—â–∏–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞, —Å—Ç–∞—Ç—É—Å –∏ –∫–ª—é—á–µ–≤—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã (RID, –ø–æ–ª–µ, —Å—Å—ã–ª–∫–∏, —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ–∏—Å–∫–∞), `render_tool_summaries_markdown()` —Å—Ç—Ä–æ–∏—Ç Markdown-–±–ª–æ–∫ —Å quote ¬´üîß ‚Ä¶¬ª, –∞ `render_tool_summaries_plain()` –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç–µ –∂–µ —Å—Ç—Ä–æ–∫–∏ –≤ —Ç–µ–∫—Å—Ç–æ–≤—É—é –≤–µ—Ä—Å–∏—é –∏—Å—Ç–æ—Ä–∏–∏. –¢–µ–ø–µ—Ä—å `LocalAgent` –ø–µ—Ä–µ–¥–∞—ë—Ç –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ tool-calls –≤ —á–∞—Ç –ø–æ –º–µ—Ä–µ –∏—Ö –ø–æ—è–≤–ª–µ–Ω–∏—è: `run_command(..., on_tool_result=...)` –¥–æ–±–∞–≤–ª—è–µ—Ç payload –≤ `_AgentRunHandle.streamed_tool_results`, `_handle_streamed_tool_results()` –æ–±–Ω–æ–≤–ª—è–µ—Ç pending-–æ—Ç–≤–µ—Ç –∏ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç transcript, –ø–æ—ç—Ç–æ–º—É –Ω–∞–¥–ø–∏—Å—å ¬´–ñ–¥—ë–º –æ—Ç–≤–µ—Ç‚Ä¶¬ª —Å—Ä–∞–∑—É –¥–æ–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º. –ï—Å–ª–∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç `tool_results` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑-–∑–∞ —Ä–∞–Ω–Ω–µ–π –æ—à–∏–±–∫–∏), `_finalize_prompt()` –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫, —á—Ç–æ–±—ã –∏—Å—Ç–æ—Ä–∏—è –∏ –∂—É—Ä–Ω–∞–ª –Ω–µ —Ç–µ—Ä—è–ª–∏ –¥–µ—Ç–∞–ª—å–Ω—É—é —Å–≤–æ–¥–∫—É.„ÄêF:app/ui/agent_chat_panel/tool_summaries.py‚Ä†L25-L198„Äë„ÄêF:app/ui/agent_chat_panel/panel.py‚Ä†L831-L907„Äë„ÄêF:app/ui/agent_chat_panel/panel.py‚Ä†L1388-L1468„Äë„ÄêF:app/ui/agent_chat_panel/panel.py‚Ä†L2010-L2056„Äë
- –î–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏—Å—Ç–æ—Ä–∏–∏ —Å —Ä–∞–±–æ—á–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ —á–∞—Ç —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–¥–∞—ë—Ç —É—Å–ø–µ—à–Ω—ã–µ `tool_results` –≤ `MainFrameAgentMixin`: `AgentChatPanel.set_tool_result_handler()` –Ω–∞–≤–µ—à–∏–≤–∞–µ—Ç –∫–æ–ª–±—ç–∫ –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞, `_notify_tool_results()` —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç payloads –∏ –≤—ã–∑—ã–≤–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫, –∞ `MainFrameAgentMixin._on_agent_tool_results()` –æ–±–Ω–æ–≤–ª—è–µ—Ç `RequirementModel`, –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç `ListPanel.recalc_derived_map()`, –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Ä–µ–¥–∞–∫—Ç–æ—Ä –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è. –ë–ª–∞–≥–æ–¥–∞—Ä—è —ç—Ç–æ–º—É –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ —Å—Ç–∞—Ç—É—Å—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –º–µ–Ω—è—é—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–æ–≤ `update_requirement_field`, `set_requirement_*`, `link_requirements`, `delete_requirement` –±–µ–∑ —Ä—É—á–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–∏—Å–∫–∞.„ÄêF:app/ui/agent_chat_panel/panel.py‚Ä†L198-L378„Äë„ÄêF:app/ui/agent_chat_panel/panel.py‚Ä†L1506-L1536„Äë„ÄêF:app/ui/agent_chat_panel/panel.py‚Ä†L2048-L2096„Äë„ÄêF:app/ui/main_frame/frame.py‚Ä†L224-L334„Äë„ÄêF:app/ui/main_frame/agent.py‚Ä†L114-L244„Äë
- –ü–æ—Å–ª–µ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ –∂—É—Ä–Ω–∞–ª —Ç–µ–ø–µ—Ä—å —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ –±–∞–∑–µ `ChatEntry.diagnostic`: –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ `_build_entry_diagnostic()` —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç —Å–Ω–∏–º–æ–∫ –∏—Å—Ç–æ—Ä–∏–∏, –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ MCP –∏ –æ—Ç–≤–µ—Ç–∞ LLM, —á—Ç–æ–±—ã `_compose_transcript_log_text()` –≤—ã–≤–æ–¥–∏–ª —Å–µ–∫—Ü–∏–∏ —Å—Ç—Ä–æ–≥–æ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ¬´Agent ‚Üí LLM ‚Üí MCP ‚Üí User¬ª, –∑–∞–ø–æ–ª–Ω—è—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —ç—Ç–∞–ø—ã –ø–æ–º–µ—Ç–∫–∞–º–∏ `(none)`/`(–Ω–µ –±—ã–ª–æ)` –∏ —Å–æ—Ö—Ä–∞–Ω—è—è –≤–µ—Å—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π payload –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.„ÄêF:app/ui/chat_entry.py‚Ä†L10-L120„Äë„ÄêF:app/ui/agent_chat_panel/panel.py‚Ä†L1605-L1876„Äë„ÄêF:app/ui/agent_chat_panel/panel.py‚Ä†L2078-L2179„Äë
- –†–∞–∑–º–µ—Ç–∫–∞ –º–µ–∂–¥—É –ø–∞–Ω–µ–ª—è–º–∏ —Å—Ç—Ä–æ–∏—Ç—Å—è —à—Ç–∞—Ç–Ω—ã–º–∏ `wx.SplitterWindow` –ø—Ä—è–º–æ –≤ `main_frame/frame.py` –∏ `agent_chat_panel/panel.py`, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è.„ÄêF:app/ui/main_frame/frame.py‚Ä†L101-L173„Äë„ÄêF:app/ui/agent_chat_panel/panel.py‚Ä†L286-L404„Äë
- –î–∏–∞–ª–æ–≥–∏: `filter_dialog.py`, `document_dialog.py`, `labels_dialog.py`, `label_selection_dialog.py`, `settings_dialog.py`, `derivation_graph.py`, `trace_matrix.py` ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤/–º–µ—Ç–æ–∫, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ LLM/MCP, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–≤—è–∑–µ–π –∏ –º–∞—Ç—Ä–∏—Ü —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏.„ÄêF:app/ui/filter_dialog.py‚Ä†L1-L73„Äë„ÄêF:app/ui/document_dialog.py‚Ä†L1-L70„Äë„ÄêF:app/ui/labels_dialog.py‚Ä†L1-L74„Äë„ÄêF:app/ui/label_selection_dialog.py‚Ä†L1-L61„Äë„ÄêF:app/ui/settings_dialog.py‚Ä†L1-L73„Äë„ÄêF:app/ui/derivation_graph.py‚Ä†L1-L55„Äë„ÄêF:app/ui/trace_matrix.py‚Ä†L1-L23„Äë
- `resources/` ‚Äî –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ (`editor_fields.json`, `editor_config.py`), –∫–æ—Ç–æ—Ä—É—é –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç `EditorPanel` –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ñ–æ—Ä–º—ã.

### `app/agent/`
- `local_agent.py` ‚Äî –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π `LocalAgent`, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∏–π `LLMClient` –∏ `MCPClient`, –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (`check_llm`, `check_tools`) –∏ —Ü–∏–∫–ª –∞–≥–µ–Ω—Ç–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: –º–æ–¥–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `LLMResponse` —Å —Ç–µ–∫—Å—Ç–æ–º –∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏, –∞–≥–µ–Ω—Ç –ø–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –≤—ã–∑–æ–≤–æ–º MCP-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞ (–ø—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –≤—ã–∑–æ–≤–∞—Ö –ø–æ–≤—Ç–æ—Ä–Ω–æ –Ω–µ —Ö–æ–¥–∏—Ç –Ω–∞ `/health`, –ø–æ–∫–∞ –Ω–µ –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç –æ—à–∏–±–∫–∞), –¥–æ–±–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç—ã –≤ –∏—Å—Ç–æ—Ä–∏—é –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç LLM –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è; –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ—Ç–º–µ–Ω—É —á–µ—Ä–µ–∑ —Ç–æ–∫–µ–Ω—ã, –ø—Ä–µ—Ä—ã–≤–∞—è –æ–∂–∏–¥–∞–Ω–∏–µ LLM –∏ –Ω–µ –∑–∞–ø—É—Å–∫–∞—è –Ω–æ–≤—ã–µ tool-calls –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è ¬´–°—Ç–æ–ø¬ª. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ `run_command`/`run_command_async` –ø—Ä–∏–Ω–∏–º–∞—é—Ç `on_tool_result`, –∫–æ—Ç–æ—Ä—ã–π `_execute_tool_calls_core()` –≤—ã–∑—ã–≤–∞–µ—Ç —á–µ—Ä–µ–∑ `_emit_tool_result()` —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ—á–µ—Ä–µ–¥–Ω–æ–≥–æ MCP-–≤—ã–∑–æ–≤–∞, –±–ª–∞–≥–æ–¥–∞—Ä—è —á–µ–º—É UI –∏ —Ç–µ—Å—Ç—ã –º–æ–≥—É—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –µ—â—ë –¥–æ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞. –ö–ª–∏–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å —è–≤–Ω—ã–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (`check_llm_async`, `respond_async`, `check_tools_async`, `ensure_ready_async`, `call_tool_async`), –∞ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–±—ë—Ä—Ç–∫–∏ –∞–≥–µ–Ω—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `_run_sync`, —á—Ç–æ–±—ã –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–æ—Ä—É—Ç–∏–Ω—ã –≤–Ω–µ –¥–µ–π—Å—Ç–≤—É—é—â–µ–≥–æ —Ü–∏–∫–ª–∞ —Å–æ–±—ã—Ç–∏–π. –ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ –∫ LLM —Ç–µ–ø–µ—Ä—å —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è: –∞–≥–µ–Ω—Ç –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç —à–∞–≥–∏ `result["diagnostic"]["llm_requests"]`, –≥–¥–µ –∫–∞–∂–¥—ã–π —à–∞–≥ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫ `messages`; UI –∏–∑–≤–ª–µ–∫–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–≥ –¥–ª—è –∂—É—Ä–Ω–∞–ª–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –º–Ω–æ–≥–æ—à–∞–≥–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.„ÄêF:app/agent/local_agent.py‚Ä†L1-L214„Äë„ÄêF:app/agent/local_agent.py‚Ä†L268-L485„Äë

### `app/llm/`
- `client.py` ‚Äî HTTP-–∫–ª–∏–µ–Ω—Ç –ø–æ–≤–µ—Ä—Ö `openai.OpenAI`: –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ (`check_llm`), –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ (`respond`/`parse_command`) —Å –≤–æ–∑–≤—Ä–∞—Ç–æ–º `LLMResponse` ‚Äî —Ç–µ–∫—Å—Ç–∞ –∏ –Ω–∞–±–æ—Ä–∞ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö `LLMToolCall`, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞, —Ä–∞–∑–±–æ—Ä –∏—Å—Ç–æ—Ä–∏–∏ —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ `assistant`/`tool`, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ SSE-–ø–æ—Ç–æ–∫–∞ –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ —á–µ—Ä–µ–∑ `CancellationEvent`. –ü—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –∑–∞–ø—Ä–æ—Å–∞ `LLMClient` –¥–µ–ª–∞–µ—Ç JSON-safe –∫–æ–ø–∏—é `messages`, –≤–∫–ª–∞–¥—ã–≤–∞–µ—Ç –µ—ë –≤ `LLMResponse.request_messages` –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –æ—Ç–≤–µ—Ç–µ, —á—Ç–æ–±—ã –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ —Å–ª–æ–∏ –º–æ–≥–ª–∏ —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π payload, –∞ –Ω–µ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –ø–æ –∫–æ—Å–≤–µ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º.„ÄêF:app/llm/client.py‚Ä†L1-L160„Äë„ÄêF:app/llm/client.py‚Ä†L308-L533„Äë

### `app/util/`
- `cancellation.py` ‚Äî –ª—ë–≥–∫–∏–π `CancellationEvent` –ø–æ–≤–µ—Ä—Ö `threading.Event` –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ `OperationCancelledError`, –ø–æ–∑–≤–æ–ª—è—é—â–∏–µ –∏–∑ GUI –∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –∑–∞–∫—Ä—ã–≤–∞—Ç—å –ø–æ—Ç–æ–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏ —Å–Ω–∏–º–∞—Ç—å –æ–∂–∏–¥–∞–Ω–∏—è –≤ —Ñ–æ–Ω–æ–≤—ã—Ö –ø–æ—Ç–æ–∫–∞—Ö.„ÄêF:app/util/cancellation.py‚Ä†L1-L59„Äë
- `constants.py` ‚Äî –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ª–∏–º–∏—Ç—ã —Ç–æ–∫–µ–Ω–æ–≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞; `spec.py` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –∏ –æ–ø–∏—Å–∞–Ω–∏–µ MCP-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤; `validation.py` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤—ã–∑–æ–≤–æ–≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.

### `app/mcp/`
- `server.py` ‚Äî FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å —Ä—É—á–Ω—ã–º –º–∞—Ä—à—Ä—É—Ç–æ–º `/mcp`: middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –∂—É—Ä–Ω–∞–ª—ã –∑–∞–ø—Ä–æ—Å–æ–≤, –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ `uvicorn` –∏ —Ä–µ–µ—Å—Ç—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, —Ñ–æ—Ä–º–∏—Ä—É–µ–º—ã–π –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–º `register_tool`. –ö–∞–∂–¥—ã–π HTTP-–∑–∞–ø—Ä–æ—Å –ø–æ–ª—É—á–∞–µ—Ç `request_id`, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ `server.jsonl`, –∞ –∑–∞–ø–∏—Å–∏ –æ –≤—ã–∑–æ–≤–∞—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏–≤—è–∑—ã–≤–∞—é—Ç—Å—è –∫ —Ç–æ–º—É –∂–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—É. –ü—Ä–∏ –ø—É—Å—Ç–æ–º `base_path` —Å–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥ `mcp` –≤–Ω—É—Ç—Ä–∏ –æ–±—â–µ–≥–æ –ª–æ–≥-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –ø–æ—ç—Ç–æ–º—É –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ `fastapi`, `uvicorn` –∏ `httpx`; –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º `FastMCP` –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è `typer>=0.9` –∏ `rich`, –Ω–æ –≤ —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º—ã –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ –æ—Å—Ç–∞—ë–º—Å—è –Ω–∞ —Ä—É—á–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞–¥ –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º.„ÄêF:app/mcp/server.py‚Ä†L34-L146„Äë„ÄêF:app/mcp/server.py‚Ä†L240-L347„Äë
- `controller.py` ‚Äî `MCPController` —É–ø—Ä–∞–≤–ª—è–µ—Ç –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º —Å–µ—Ä–≤–µ—Ä–∞ –∏ health-check (`MCPCheckResult`).„ÄêF:app/mcp/controller.py‚Ä†L1-L60„Äë
- `client.py` ‚Äî HTTP-–∫–ª–∏–µ–Ω—Ç –Ω–∞ –±–∞–∑–µ `httpx` —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è–º–∏ –ø–µ—Ä–µ–¥ –æ–ø–∞—Å–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏, –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω—ã–º health-check `/health`, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç —É—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –±–æ–ª—å—à–µ –Ω–µ –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç endpoint –¥–æ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–∏ (–º–µ—Ç–æ–¥ `ensure_ready`), –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º/–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–º –æ–±—â–µ–µ –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–µ—Ä–µ–≤–æ–¥—è—â–∏–º —Å–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏ MCP –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã.„ÄêF:app/mcp/client.py‚Ä†L1-L248„Äë„ÄêF:app/mcp/client.py‚Ä†L250-L430„Äë
- `tools_read.py` –∏ `tools_write.py` ‚Äî –∞–¥–∞–ø—Ç–µ—Ä—ã –º–µ–∂–¥—É MCP-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –∏ `document_store`, –ª–æ–≥–∏—Ä—É—é—â–∏–µ –≤—ã–∑–æ–≤—ã –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—â–∏–µ –æ—Ç–≤–µ—Ç—ã; `tools_write.py` –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç –º–∏–∫—Ä–æ-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (`update_requirement_field`, `set_requirement_labels`, `set_requirement_attachments`, `set_requirement_links`), —É–ø—Ä–æ—â–∞—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç –¥–ª—è LLM –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—è –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –±–µ–∑ —É—á–∞—Å—Ç–∏—è –∫–ª–∏–µ–Ω—Ç–∞.„ÄêF:app/mcp/tools_read.py‚Ä†L1-L77„Äë„ÄêF:app/mcp/tools_write.py‚Ä†L1-L182„Äë
- `utils.py` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä –æ—à–∏–±–æ–∫ (`mcp_error`), –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–∫–ª—é—á–µ–Ω–∏–π, –æ–±—â–µ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (`log_tool`).„ÄêF:app/mcp/utils.py‚Ä†L1-L74„Äë

### `app/cli/`
- `main.py` ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ CLI, —Å–æ–±–∏—Ä–∞–µ—Ç `argparse` –∏ –≥—Ä—É–∑–∏—Ç `AppSettings` –∏–∑ —Ñ–∞–π–ª–∞; `__main__.py` –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ `python -m app.cli`.
- `commands.py` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–¥–∫–æ–º–∞–Ω–¥ (`doc`, `item`, `link`, `trace`, `check` –∏ –¥—Ä.), —Ä–∞–∑–±–æ—Ä –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –≤ `ItemPayload`, –≤—ã–∑–æ–≤—ã `document_store` –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–≤–æ–¥–æ–≤ (CSV/HTML –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏).„ÄêF:app/cli/commands.py‚Ä†L1-L88„Äë„ÄêF:app/cli/commands.py‚Ä†L90-L166„Äë

### `app/llm`, `app/mcp` –∏ GUI
GUI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç LLM/MCP —á–µ—Ä–µ–∑ —á–∞—Ç-–ø–∞–Ω–µ–ª—å –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: `AgentChatPanel` —Å–æ–∑–¥–∞—ë—Ç `LocalAgent`, `SettingsDialog` —É–º–µ–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é `LLMClient`/`MCPClient` –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å `MCPController`.

### –ü—Ä–æ—á–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∏
- `requirements/` ‚Äî –ø—Ä–∏–º–µ—Ä —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π: –∫–∞—Ç–∞–ª–æ–≥–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (`SYS`, `HLR`, ‚Ä¶) —Å `document.json` –∏ —Ñ–∞–π–ª–∞–º–∏ `items/<ID>.json`.
- `tests/` ‚Äî —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–∞–º: `unit/` (–º–æ–¥—É–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —è–¥—Ä–∞ –∏ —É—Ç–∏–ª–∏—Ç), `integration/` (—Å–≤—è–∑–∫–∞ LLM/MCP/CLI), `gui/` (wx-–æ–∫–Ω–∞ –ø–æ–¥ xvfb), `smoke/` (–±—ã—Å—Ç—Ä—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏), `slow/` (–¥–æ–ª–≥–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏, –æ—Ç–∫–ª—é—á–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).
- `tools/` ‚Äî –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ —Å–ª—É–∂–µ–±–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.
- `build.py` ‚Äî —Å–±–æ—Ä–∫–∞ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞ —á–µ—Ä–µ–∑ PyInstaller, –¥–æ–±–∞–≤–ª—è–µ—Ç –∏–∫–æ–Ω–∫—É –∏ —Ä–µ—Å—É—Ä—Å—ã GUI.„ÄêF:build.py‚Ä†L1-L39„Äë
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (`pyproject.toml`, `pytest.ini`, `requirements*.txt`) –∑–∞–¥–∞—é—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, —Ñ–ª–∞–≥–∏ —Ç–µ—Å—Ç–æ–≤ –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ.

## –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä —Å–ª–æ—è
- –ù—É–∂–µ–Ω GUI ‚Äî —Å—Ç–∞—Ä—Ç—É–π—Ç–µ —Å `app/main.py` –∏ `app/ui/main_frame/`.
- –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–∞–≤–∫–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ ‚Äî —Å–º–æ—Ç—Ä–∏—Ç–µ `app/core/model.py` –∏ `app/core/document_store/*`.
- –ò–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è/LLM ‚Äî –∏–∑—É—á–∞–π—Ç–µ `app/agent/local_agent.py`, `app/llm/client.py`, `app/mcp/*`.
- –¢—Ä–µ–±—É–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî `app/cli/commands.py` –∏ `app/cli/main.py`.

–î–æ–∫—É–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –ø–æ –º–µ—Ä–µ –ø–æ—è–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–æ–¥—Å–∏—Å—Ç–µ–º, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω—è–ª–∞—Å—å –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤.
