# AGENTS

Этот файл содержит рабочий план и инструкции для разработки приложения "CookaReq" (от игры слов "cook a requirements").

## Общие инструкции
- Работать в основной ветке (без новых веток).
- Перед каждым коммитом выполнять `pytest`.
- Перед началом новой фичи сверяться с `Plan.md` для понимания доменной логики и формата данных.
- После завершения шага отмечать его выполненным и фиксировать в журнале.
- Пользователь будет писать "делай дальше" для перехода к следующему шагу.

## План разработки

0. **Ознакомление**
   - Прочитать `Plan.md` — там описаны доменная модель, сценарии и критерии готовности.

1. **Каркас проекта** ✅
   1.1. Создать каталоги `app/core`, `app/ui`, `app/util`.
   1.2. Подготовить `pyproject.toml` с зависимостями (`wxPython`, `pytest`).
   1.3. Разместить пустые `__init__.py` в новых каталогах.
   1.4. Настроить `.gitignore` и базовую конфигурацию тестов.

2. **Утилиты** ✅
   2.1. `util/hashing.py`: функция `id_to_hash` → короткий SHA-256 (12–16 hex) и тесты.
   2.2. `util/paths.py`: работа с относительными путями и тесты.

3. **Модель и валидация** ✅
    3.1. `core/model.py`: dataclass `Requirement` с типизацией и enum.
    3.2. Тесты для модели.
    3.3. `core/schema.py`: JSON Schema + проверка.
    3.4. `core/validate.py`: бизнес-правила (уникальность id, обязательность acceptance и т.д.).
    3.5. Тесты для схемы и правил.

4. **Хранилище JSON** ✅
  4.1. `core/store.py`: чтение и запись требований, генерация имён по хэшу.
  4.2. Обработка конфликтов по mtime.
  4.3. Тесты на чтение/запись и обнаружение конфликтов.

5. **Поиск и фильтры** ✅
   5.1. `core/search.py`: фильтрация по меткам.
   5.2. Текстовый поиск по выбранным полям.
   5.3. Тесты на поиск.

6. **GUI: каркас** ✅
   6.1. `app/main.py`: запуск приложения и основного окна.
   6.2. `ui/main_frame.py`: меню, тулбар, выбор папки.
   6.3. `ui/list_panel.py`: отображение списка и фильтров.
   6.4. Smoke-тесты для импортов GUI.

7. **GUI: редактор** ✅
   7.1. `ui/editor_panel.py`: форма редактирования полей.
   7.2. Создание нового требования.
   7.3. Клонирование существующего.
   7.4. Сохранение и удаление.
   7.5. Работа с вложениями.
   7.6. Тесты с использованием временных каталогов.

8. **Локализация и словари** ✅
   8.1. Словарь код ↔ русский текст.
   8.2. Подключение словарей к GUI.

9. **Сборка PyInstaller**
   9.1. Скрипт сборки `build.py`.
   9.2. Инструкции в `README`.

## Журнал выполнения
- 2025-09-10: Сформирован подробный план разработки и добавлена ссылка на `Plan.md`.
- 2025-09-10: Выполнен шаг 1 — создан каркас проекта (директории, `pyproject.toml`, `__init__.py`).
- 2025-09-10: Выполнен шаг 2 — добавлены утилиты `hashing` и `paths` с тестами.
- 2025-09-10: Выполнен шаг 3 — реализована модель требований, схема и бизнес-валидация с тестами.
- 2025-09-10: Добавлены `.gitignore` и `pytest.ini` для упрощения разработки.
- 2025-09-11: Выполнен шаг 4 — реализовано хранилище JSON с проверкой конфликтов по mtime.
- 2025-09-11: Выполнен шаг 5 — реализованы поиск по меткам и текстовый поиск.
- 2025-09-11: Выполнен шаг 6 — подготовлен каркас GUI (главное окно и список требований).
- 2025-09-11: Выполнен шаг 7 — реализован редактор требований с возможностью создания, клонирования, сохранения, удаления и работы с вложениями.
- 2025-09-11: Добавлен словарь код ↔ русский текст для локализации.
- 2025-09-12: Подключены словари к GUI.
