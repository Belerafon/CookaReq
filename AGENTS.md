# AGENTS

Этот файл содержит инструкции и краткую архитектуру приложения "CookaReq".

## Общие инструкции

- Работать в основной ветке (без новых веток).
- Запускать `pytest -q`; тесты с маркером `slow` пропускаются.
- При повторном включении тестов, использующих `wx`, запускать их в виртуальном дисплее (плагин `pytest-xvfb` или обёртка `xvfb-run -a`).
- Для сборки и тестов использовать системный Python 3.12.3. В корне лежит файл `.python-version` со значением `system`, поэтому `pyenv` переключается автоматически; запускать команды следует через `python3`. Команда `python` отсутствует. Все требуемые пакеты (включая `wxPython`) уже предустановлены в системной инсталляции; проверено, что команда `python3 -c "import wx; print(wx.version())"` отрабатывает без ошибок.
- Ключ OpenRouter хранится в файле `.env` в корне репозитория в переменной `OPEN_ROUTER`. Тесты и приложение читают ключ из окружения при наличии.
- По умолчанию тесты используют мок LLM и не обращаются к внешнему API. Чтобы запустить реальные интеграционные проверки, установите `COOKAREQ_RUN_REAL_LLM_TESTS=1` и выполняйте тесты с маркером `real_llm`, например:
  `COOKAREQ_RUN_REAL_LLM_TESTS=1 pytest tests/test_llm_openrouter_integration.py::test_openrouter_check_llm -q`. Без ключа `OPEN_ROUTER` или указанного флага такие тесты будут пропущены.

## Краткая архитектура

Приложение построено по слоистой схеме:

- **GUI** (`app/ui`) общается с контроллерами, которые обращаются к сервисам и модулю `app/core`.
- **Хранилище требований** представлено JSON-документами в каталоге `requirements/` и обслуживается `doc_store`.
- **LLM и MCP** компоненты взаимодействуют с хранилищем через `LocalAgent` и `MCPClient`.
- **Сборка** производится скриптом `build.py` через PyInstaller.

